

$(pK_0)^a=(g^k)^a=(g^a)^k$,

$(PK_1)^a=C^a/(g^k)^a=C^a/(g^a)^k$
$$
c_{0,0}=En_{k_1^0,k_2^0}(k_3^0)=En_(k_1^0)(En_{k_2^0}(k_3^0))
$$

$$
c_{0,1}=En_{k_1^0,k_2^1}(k_3^0)=En_(k_1^0)(En_{k_2^1}(k_3^0))
$$

$$
c_{1,0}=En_{k_1^1,k_2^0}(k_3^0)=En_(k_1^1)(En_{k_2^0}(k_3^0))
$$

$$
c_{1,1}=En_{k_1^1,k_2^1}(k_3^1)=En_(k_1^1)(En_{k_2^1}(k_3^1))
$$

![image-20230726005709909](./assets\ABYè®ºæ–‡\image-20230726005709909.png)

$æ¢å¤å¸ƒå°”ç§˜å¯†ï¼ša = a_1 \oplus a_2, b = b_1 \oplus b_2$

$ABå…±åŒè®¡ç®—,Aæœ¬åœ°è®¡ç®—a_1 \oplus b_1ï¼ŒBæœ¬åœ°è®¡ç®—a_2 \oplus b_2ï¼Œ$
$$
(a_1 \oplus b_1) \oplus (a_2 \oplus b_2)= (a_1 \oplus r_12 \oplus r_21) \oplus (a_2 \oplus r_21 \oplus r_21) = a1 \oplus a_2
$$
$å¯¹äºa \wedge bï¼Œè¿™é‡Œä½¿ç”¨OTæ¥å®Œæˆï¼Œ$

$a \wedge b = (a_1 \oplus a_2) \wedge (b_1 \oplus b_2)=(a_1 \wedge b_1)\oplus(a_1 \wedge b2)\oplus(a_2 \wedge b1)\oplus(a_2 \wedge b_2)$ 

$(a_1 \wedge b_2) \oplus (a_2 \wedge b_1)$éœ€è¦ä¸¤è€…åä½œå®Œæˆè®¡ç®—ï¼Œå¯ä»¥é€šè¿‡å››é€‰ä¸€ä¸ç»æ„ä¼ è¾“åè®®å®Œæˆï¼Œå¯¹äºAæ¥è¯´ï¼ŒBæ‰‹ä¸­çš„$a_2å’Œb_2$éƒ½æ˜¯å•æ¯”ç‰¹å€¼ï¼Œæœ‰å››ç§æƒ…å†µ$(0,0),(0,1),(1,0),(1,1)$ã€‚

Aæ‰‹ä¸­æœ‰$a_1å’Œb_1$ï¼ŒAä¸çŸ¥é“$a_2å’Œb_2$,å› æ­¤Aå¯ä»¥åˆ†åˆ«è®¡ç®—è¿™4ç§æƒ…å†µä¸‹$(a_1 \wedge b2)\oplus(a_2 \wedge b1)$çš„å€¼ï¼Œå‡è®¾ä¸º$c_{00},c_{01},c_{10},c_{11}(æ³¨æ„cæ˜¯a\wedge bçš„å€¼)$ï¼Œ

![image-20230726122843716](assets\ABYè®ºæ–‡\image-20230726122843716.png)

Alice å†äº§ç”Ÿä¸€ä¸ªéšæœºæ¯”ç‰¹ğ‘Ÿï¼Œå¹¶å°†è®¡ç®—å‡ºçš„$ğ‘_{00},ğ‘_{01},ğ‘_{01},ğ‘_{11}$å¼‚æˆ–ä¸Šéšæœºæ¯”ç‰¹ğ‘Ÿï¼Œå°†$ğ‘_{00}â¨ğ‘Ÿ, ğ‘_{01}â¨ğ‘Ÿ, ğ‘_{01}â¨ğ‘Ÿ, ğ‘_{11}â¨ğ‘Ÿ$ä¸ºå››é€‰ä¸€ä¸ç»æ„ä¼ è¾“åè®®çš„è¾“å…¥ï¼ŒBobå°†å…¶æ‰€æŒæ¡çš„$a_2,b_2$ä½œä¸ºå››é€‰ä¸€ä¸ç»æ„ä¼ è¾“åè®®çš„è¾“å…¥ï¼ŒåŒæ–¹æ‰§è¡Œè¯¥OTåè®®ï¼ŒBobå¾—åˆ°å¯¹åº”çš„$$ğ‘_{a_2b_2}â¨ğ‘Ÿ$$ã€‚


Aliceå°†ğ‘Ÿä½œä¸ºè¯¥ä¸é—¨çš„è¾“å‡ºçš„å­ç§˜å¯†ï¼ŒBobå°†$ğ‘_{a_2b_2}â¨ğ‘Ÿ$ä½œä¸ºè¯¥ä¸é—¨çš„è¾“å‡ºçš„å­ç§˜å¯†ã€‚åªæœ‰åœ¨æœ€ååŒæ–¹éƒ½å…¬å¸ƒå„è‡ªæ‰‹ä¸­çš„è®¡ç®—ç»“æœï¼ŒåŒæ–¹æ‰èƒ½åˆåŠ›è®¡ç®—å‡ºæ­£ç¡®çš„ç»“æœã€‚



å°†GMWåè®®æ‰©å±•åˆ°næ–¹æƒ…å†µä¸‹ï¼š

1ã€å‚ä¸è€…ä¸º$p_1,p_2,..p_n$ï¼Œå‡è®¾è¾“å…¥ä¸ºmä¸ªæ¯”ç‰¹ï¼Œé‚£ä¹ˆæ¯ä¸ªå‚ä¸è€…$p_i$äº§ç”Ÿmç»„ï¼Œæ¯ç»„$n-1$ä¸ªæ¯”ç‰¹ã€‚é’ˆå¯¹ä¸€ä¸ªæ¯”ç‰¹æ¥è¯´ï¼Œå°†$n-1$ä¸ªéšæœºæ¯”ç‰¹å‘é€ç»™å…¶ä»–$n-1$ä¸ªå‚ä¸è€…ã€‚

2ã€å‡è®¾è¾“å…¥æ•°æ®ä¸º1ä¸ªæ¯”ç‰¹ï¼Œæ¯ä¸ªå‚ä¸è€…$p_i$å‘å‚ä¸è€…$p_j$å‘é€$r_{ij},1\leq j\leq n ä¸”i \neq j$ï¼Œå‡è®¾$p_i$çš„è¾“å…¥ä¸º$a$,é‚£ä¹ˆ$p_i$å°†$a \oplus r_{i1} \oplus r_{i2} \oplus ... \oplus r_{in}$ä½œä¸º$a$çš„å­ç§˜å¯†$a_i$ã€‚

3ã€å¯¹åº”çš„æ”¶åˆ°$p_i$å‘é€çš„éšå³æ¯”ç‰¹$r_{ij}$çš„å‚ä¸è€…$p_j$ï¼Œå°†$r_{ij}$ä½œä¸º$a$çš„å­ç§˜å¯†$a_j$ï¼Œå› æ­¤$a=a_1 \oplus a_2 \oplus... \oplus a_n$

![image-20230726125952641](assets\ABYè®ºæ–‡\image-20230726125952641.png)

æ¯ä¸ª$bit$è¢«æ‹†æˆäº†nä»½ï¼Œæ¢å¤ç§˜å¯†ï¼š

1ã€$a \oplus b =(a_1 \oplus a_2 \oplus...\oplus a_n) \oplus (b_1 \oplus b_2 \oplus...\oplus b_n)=(a_1 \oplus b_1)\oplus(a_2 \oplus b_2)\oplus.... \oplus(a_n \oplus b_n)$ 

2ã€$a \wedge b =(a_1 \oplus...\oplus a_n)\wedge(b_1 \oplus..\oplus b_n)=(\mathop{\oplus}\limits_{i \neq j}a_i \wedge b_j) \oplus(\mathop{\oplus}\limits_{i=1}^n a_i \wedge b_i)$

- å¯¹äº$i \neq j$ï¼Œ$p_i$å’Œ$p_j$åˆ©ç”¨ä¸ç»æ„ä¼ è¾“åè®®å…±åŒè®¡ç®—$a_i \wedge b_j$ã€‚

- $p_i$æœ¬åœ°éšæœºç”Ÿæˆ$c_{ij} \in \{0,1\}$ï¼Œ$f(x)=c_{ij} \oplus(a_i \wedge x)ç”Ÿæˆf(0),f(1)$

- $p_iä¸p_j$è¿›è¡Œ${OT}^2_1$ï¼Œ$P_i$æä¾›è¾“å…¥$\{f(0,f(1)\}$ï¼Œ$P_j$æ ¹æ®$b_j$çš„çœŸå®å€¼é€‰æ‹©$f(b_j)$ï¼Œè®°ä½œ$d_{ji}$ï¼Œä¸éš¾å‘ç°$c_{ij} \oplus d_{ji}=a_i \wedge b_j$ã€‚

- $P_i$æœ¬åœ°è®¡ç®—$e_i= \mathop{\oplus}_{1 \leq j \leq n, j \neq i}c_{ij}$å’Œ$f_i= \mathop{\oplus}_{1 \leq j \leq n, j \neq i}d_{ij}$ï¼Œæœ¬åœ°è®¡ç®—$(a_i \wedge b_i) \oplus e_i \oplus f_i$ã€‚åœ¨æ­¤è¿‡ç¨‹ç§$aiå’Œb_i$çš„å­ç§˜å¯†ä¸€ç›´æ²¡æœ‰æ³„éœ²ï¼Œåœ¨ä¿è¯éšç§çš„æƒ…å†µä¸‹ç®—å‡ºæ¥ANDã€‚

å…¬å¼ï¼š
$$
a \wedge b = (\mathop{\oplus}\limits_{i \neq j}a_i \oplus b_j)\oplus(\mathop{\oplus}\limits_{i=1}^n a_i \wedge b_i)\\
=(\mathop{\oplus}\limits_{i \neq j}c_{ij} \oplus d_{ij})\oplus(\mathop{\oplus}\limits_{i=1}^n a_i \wedge b_i)\\
= (\mathop{\oplus}\limits_{i =1}^n e_i) \oplus(\mathop{\oplus}\limits_{i =1 }^n f_i)\oplus(\mathop{\oplus}\limits_{i=1}^n a_i \wedge b_i)\\
=\mathop{\oplus}\limits_{i=1}^n(a_i \wedge b_i) \oplus e_i \oplus f_i
$$


---

ä½œè€…æå‡ºäº†ABYæ¡†æ¶ï¼Œæ”¯æŒä¸‰ç§ä¸åŒç±»å‹çš„åˆ†äº«ï¼ˆ**A**rithmetic, **B**oolean, **Y**aoï¼‰ï¼Œå¹¶å…è®¸ä¸‰è€…ä¹‹é—´çš„æœ‰æ•ˆè½¬æ¢

æ¯ç§å®‰å…¨è®¡ç®—æŠ€æœ¯éƒ½ä½¿ç”¨æœ€æ–°çš„ä¼˜åŒ–å’Œæœ€ä½³å®è·µæ¥å®Œæˆï¼ˆPaillieræ‰“åŒ…ã€DGKç”Ÿæˆä¹˜æ³•ä¸‰å…ƒç»„ã€OTç­‰ï¼‰

å¹¶å¯¹æ¡†æ¶è¿›è¡Œæµ‹è¯•ï¼Œä½¿ç”¨åŸºäºOTçš„è½¬æ¢åè®®ï¼Œä¸åŒå…±äº«ä¹‹é—´çš„è½¬æ¢æ›´åŠ ä¾¿å®œä¸”æ›´å¥½æ‰©å±•ã€‚



# ABY â€“ A Framework for EfficientMixed-Protocol Secure Two-Party Computation

## ***Preliminaries\***

#### **Two-Party Setting**

åŒæ–¹éƒ½æä¾›è‡ªå·±çš„ç§äººè¾“å…¥ç„¶åè®¡ç®—å‡ºæœ€åçš„ç»“æœï¼Œè¿‡ç¨‹ä¸­ä¸å­¦ä¹ ä»»ä½•ä¸­é—´ä¿¡æ¯

#### **Security Against Semi-Honest Adversary**

<u>åè®®ä½¿ç”¨åŠè¯šå®å¯¹æ‰‹æ¨¡å‹ï¼Œå¯¹æ‰‹ä¸å…è®¸åç¦»åè®®ï¼Œéœ€è¦æ­£ç¡®çš„æ‰§è¡Œåè®®ï¼Œä½†æ˜¯è¯•å›¾åœ¨åè®®æ‰§è¡Œè¿‡ç¨‹æœŸé—´çœ‹åˆ°çš„ä¿¡æ¯ä¸­å­¦ä¹ é¢å¤–çš„ä¿¡æ¯ã€‚</u>è™½ç„¶æ¯”æ¶æ„æ¨¡å‹æ›´å…·æœ‰é™åˆ¶æ€§ï¼Œä½†åŠè¯šå®æ¨¡å‹æœ‰è®¸å¤šåº”ç”¨ï¼Œå¯ä»¥ä¿¡ä»»å„æ–¹ä¸ä¼šä¸»åŠ¨è¡Œä¸ºä¸å½“ï¼ŒåŠè¯šå®æ¨¡å‹ä½¿å¾—å¼€å‘é«˜æ•ˆçš„å®‰å…¨è®¡ç®—åè®®æˆä¸ºå¯èƒ½ï¼Œå› æ­¤è¢«å¹¿æ³›ç”¨äºå®ç°éšç§ä¿æŠ¤åº”ç”¨ã€‚

æˆ‘ä»¬çš„å·¥ä½œé‡ç‚¹æ˜¯åœ¨åŠè¯šå®å¯¹æ‰‹æ¨¡å‹ä¸­è®¾è®¡å’Œå®ç°é«˜æ•ˆçš„æ··åˆåè®®å®‰å…¨ä¸¤æ–¹è®¡ç®—ã€‚

| $P_0,P_1$          | å‚ä¸æ–¹                                       |
| :----------------- | -------------------------------------------- |
| $x \oplus y$       | XOR                                          |
| $x \wedge y$       | AND                                          |
| $x[i]$             | $xä¸­çš„ç¬¬iä¸ªæ¯”ç‰¹ï¼Œx[0]æœ€ä½æœ‰æ•ˆä½$             |
| $\kappa,\phi,\sigma$ | ç³»ç»Ÿå®‰å…¨å‚æ•° ($\kappa \in\{20,112,128\}$) |
|  | å…¬é’¥å®‰å…¨å‚æ•°($\phi \in{1024,2048,3072}$) |
|  | ç»Ÿè®¡å®‰å…¨å‚æ•°($\sigma=40$) |
| $\lang x\rang^t_i$         | $t\in(A,B,Y)$,å…¶ä¸­$\lang x\rang_i^tè¡¨ç¤ºP_iæŒæœ‰çš„ä»½é¢$ |
| $\lang x\rang^t=Shr^t_i(x)$ | $P_iå°†è‡ªå·±çš„è¾“å…¥xåˆ†äº«ç»™p_{1-i}$              |
| $x=Rec^t(\lang x\rang^t)$  | $P_iå¾—åˆ°æœ€åè®¡ç®—ç»“æœx$                       |

![image-20230726180047169](assets\ABYè®ºæ–‡\image-20230726180047169.png)

#### Arithmetic Sharing

ä¸€ä¸ªé•¿åº¦ä¸º$l-bit$çš„å€¼$x$è¢«åˆ†æˆä¸¤ä¸ªåœ¨ç¯$Z_{2^l}$ä¸Šçš„å€¼çš„å’Œã€‚å‡è®¾æ‰€æœ‰ç®—æœ¯è¿ç®—éƒ½åœ¨ç¯$2^l$ä¸Šè¿›è¡Œï¼Œ$mod(2^l)$ã€‚

ç®—æœ¯å…±äº«æ˜¯åŸºäºåœ¨åŒæ–¹ä¹‹é—´åŠ æ€§åœ°å…±äº«ç§æœ‰å€¼

$Share \_ Value$ï¼šå¯¹äºä¸€ä¸ªé•¿åº¦ä¸º$l-bit$çš„$x$çš„Arithmetic Sharing$\lang x \rang^A$ï¼Œæœ‰$\lang x \rang _0^A+\lang x\rang_1^A=x(mod 2^l)$ï¼Œ$P_0ï¼ŒP_1$åˆ†åˆ«æŒæœ‰ä¸¤ä¸ªä»½é¢ã€‚

$Share$ï¼š$Shr_i^A(x):P_i$é€‰æ‹©éšæœºæ•°$r\in _R Z_{2^l}$ï¼Œ$ä»¤\lang x \rang_i^A=x-r,å°†rå‘é€ç»™P_{1-i},å³\lang x\rang_{1-i}^A=r$

$Reconstruction$ï¼š$Rec_i^A(x):P_{1-i}å°†è‡ªå·±çš„å€¼\lang x\rang_{1-i}^Aå‘é€ç»™P_i,è®¡ç®—x=\lang x\rang_0^A+\lang x\rang_1^A$

$Addition:$$\lang z\rang^A=\lang x\rang^A+\lang y\rang^A$ï¼Œ$P_i$æœ¬åœ°è®¡ç®—$\lang z\rang^A_i=\lang x\rang^A_i+\lang y\rang^A_i$
$$
\lang z\rang^A=\lang z\rang^A_0+\lang z\rang^A_1=(\lang x\rang_0^A+\lang y\rang_0^A)+(\lang x\rang_1^A+\lang y\rang_1^A)=x+y
$$
$Multipication$:$\lang z\rang^A=\lang x\rang^A \cdot \lang y\rang^A$ï¼Œä½¿ç”¨é¢„å…ˆè®¡ç®—å¥½çš„ä¹˜æ³•ä¸‰å…ƒç»„$\lang c\rang^A=\lang a\rang^A \cdot\lang b\rang^A$

ç”Ÿæˆéšæœºçš„ä¸‰å…ƒç»„$\lang a,b,c=ab\rang$ï¼Œ$aå’Œb$å¯¹åŒæ–¹ä¿å¯†ï¼Œä¸¤æ–¹åˆ†åˆ«æŒæœ‰$aå’Œb$çš„ç§˜å¯†

- åŒæ–¹$P_i$è®¡ç®—$\lang e\rang_i^A=\lang x\rang_i^A-\lang a\rang_i^A$å’Œ$\lang f\rang_i^A=\lang y\rang_i^A-\lang b\rang_i^A$
- åŒæ–¹è®¡ç®—$e=\lang x\rang_0^A+\lang x\rang_1^A-(\lang a\rang_1^A+\lang a\rang_0^A)=x-a$

$f=\lang y\rang_0^A+\lang y\rang_1^A-(\lang b\rang_0^A+\lang b\rang_1^A)=y-b$

- $p_iè®¡ç®—\lang z\rang_i^A=i \cdot e \cdot f + f \lang a\rang_i^A+e\lang b\rang_i^A+\lang c\rang_i^A$
- é‡æ„$z=\lang z\rang_0^A+\lang z\rang_1^A$

$$
\lang z \rang_0^A=f \lang a \rang_0^A +e\lang b \rang_0^A+\lang c \rang_0^A\\
\lang z \rang_1^A = ef + f\lang a \rang_1^A + e\lang b \rang_1^A+\lang c \rang_1^A\\
\begin{aligned}
z=\lang z \rang_0^A+\lang z \rang_1^A
&=ef+f\lang a \rang^A+e\lang b \rang^A+\lang c \rang^A\\
&=(x-a)(y-b)+(y-b)a+(x-a)b+c\\
&=xy
\end{aligned}
$$

---

**ç”Ÿæˆä¹˜æ³•ä¸‰å…ƒç»„**
$$
\begin{aligned}
\lang c \rang^A&= \lang a \rang^A \lang b \rang^A\\
&=(\lang a\rang_0^A+\lang a\rang_1^A)(\lang b\rang_0^A+\lang b\rang_1^A)\\
&=\lang a\rang_0^A\lang b\rang_0^A+\lang a\rang_0^A\lang b\rang_1^A+\lang a\rang_1^A\lang b\rang_0^A+\lang a\rang_1^A\lang b\rang_1^A
\end{aligned}
$$
1ã€åŒæ€åŠ å¯†

![image-20230726141442639](assets\ABYè®ºæ–‡\image-20230726141442639.png)

$Paillier:D(E(m_1) \cdot E(m_2))=m_1+m_2$

$E(m_1)E(m_2)=E(m_1+m_2)$

å¯ä»¥æ¨å‡ºå…¬å¼ï¼š$E(a)^b=E(b \cdot a)$

å…¶ä¸­
$$
\begin{aligned}
d&=Enc_0(\lang a\rang_0^A)^{(\lang b\rang)_1^A} \cdot Enc_0(\lang b\rang_0^A)^{(\lang a\rang)_1^A} \cdot Enc_0(r)\\
&=Enc_0(\lang a\rang_0^A\lang b\rang_1^A+\lang b\rang_0^A\lang a\rang_1^A+r)\\
Dec_0(d)&=\lang a\rang_0^A\lang b\rang_1^A+\lang b\rang_0^A\lang a\rang_1^A+r\\
\lang c\rang_0^A&=\lang a \rang_0^A \lang b \rang_0^A+\lang a\rang_0^A\lang b\rang_1^A+\lang b\rang_0^A\lang a\rang_1^A+r\\
\lang c\rang_1^A&=\lang a\rang_1^A  \lang b\rang_1^A - r
\end{aligned}
$$


2ã€COTï¼ˆcorrelated OTsï¼‰éœ€è¦ç”Ÿæˆ$2lä¸ªlä½å­—ç¬¦ä¸²çš„cOTï¼Œå³c{OT}^{2l}_l$

$P_0éšæœºç”Ÿæˆ\lang a \rang_0^A,\lang b\rang_0^A$ï¼Œ$P_1ç”Ÿæˆ\lang a\rang_1^A ,\lang b\rang_1^A$ï¼Œ$\lang a\rang_i^A \lang b\rang_i^A$å¯ä»¥åœ¨æœ¬åœ°å®Œæˆè®¡ç®—ã€‚

- è®¡ç®—$\lang a\rang_0^A\lang b\rang_1^A$ï¼šåœ¨$P_0å’ŒP_1ä¹‹é—´è¿›è¡ŒcOT^l_l$ï¼Œå…¶ä¸­$P_0ä¸ºS$ï¼Œ$P_1ä¸ºR$ã€‚

æ€»å…±è¿›è¡Œ$l$è½®(ç§˜å¯†åˆ†äº«æ•°å€¼çš„äºŒè¿›åˆ¶é•¿åº¦),ç¬¬$i$è½®ä¸­ï¼š

- $P_1$è¾“å…¥$\lang b\rang_1^A[i]$ä½œä¸ºè‡ªå·±çš„é€‰æ‹©æ¯”ç‰¹ï¼Œ$P_0$è¾“å…¥ç›¸å…³å‡½æ•°$f(x)=(\lang a\rang_0^A \cdot 2^i-x)mod 2^l$

- $P_0$è·å¾—$s_{i0},s_{i1}$ï¼Œå…¶ä¸­$s_{i0}\in_RZ^{2^l},s_{i1}=f(s_{i0})=(\lang a \rang_0^A \cdot2^i-s_{i0})mod\, 2^l$
- $P_1$è·å¾—$s_{i,\lang b\rang_1^A[i]}=(\lang b\rang_1^A[i]\cdot\lang a\rang_0^A\cdot2^i-s_{i0})mod \,2^l$
- $\lang u\rang_0^A=(\sum_{i=1}^ls_{i0})mod \,2^l$
- $\lang u\rang_1^A=(\sum_{i=1}^ls_{i\lang b\rang_1^A[i]})mod \,2^l$

![image-20230726144046979](assets\ABYè®ºæ–‡\image-20230726144046979.png)
$$
\begin{aligned}
\lang a\rang_0^A\lang b\rang_1^A&=\lang u\rang_0^A+\lang u\rang_1^A\\
&=\sum_{i=1}^l(s_{i0}+\lang b\rang_1^A[i] \cdot\lang a\rang_0^A\cdot2^i-s_{i0})\\
&=\sum_{i=1}^l(\lang b\rang_1^A[i] \cdot\lang a\rang_0^A\cdot2^i)\\
&=\lang a\rang_0^A \cdot \lang b\rang_1^A
\end{aligned}
$$


åŒç†å¯å¾—ï¼š$\lang v\rang^A=\lang \lang a\rang_1^A\lang b\rang_0^A\rang^A$

$\lang c\rang_i^A=\lang a\rang_i^A\lang b\rang_i^A+\lang u\rang_i^A+\lang v\rang_i^A$



#### Boolean Sharing

Bool Sharingä¸Arithmetic Sharingçš„å®ç°ç›¸ä¼¼

$Sharled \, Values:$$\lang x\rang_0^B,\lang x\rang_1^B$ä¸¤æ–¹åˆ†åˆ«æŒæœ‰**æŸä¸ªæ¯”ç‰¹**çš„åˆ†äº«ï¼Œæœ‰$x=\lang x\rang_0^B \oplus \lang x\rang_1^B(\lang x\rang_i^B \in Z_2)$

$Sharing:$ $Shr_i^B(x):P_i$éšæœº$r\in _R \{0,1\}$,è®¡ç®—$\lang x\rang_i^B=x\oplus r$,å°†$r$å‘é€ç»™$P_{1-i}$ï¼Œå³$\lang x\rang_{1-i}^B=r$

$Reconstruction:$$Rec_i^B(x):$ $P_{1-i}$å°†è‡ªå·±çš„$\lang x\rang_{1-i}^B$å‘é€ç»™$P_i$,$P_i$è®¡ç®—$x=\lang x\rang_0^B \oplus\lang x\rang_1^B$

$XOR:$$æœ¬åœ°è®¡ç®—\lang z\rang_i^B=\lang x\rang_i^B \oplus \lang y\rang_i^B$,$\lang z\rang^B=\lang z\rang_0^B \oplus \lang z\rang_1^B=(\lang x\rang_0^B \oplus \lang y \rang_0^B) \oplus (\lang x\rang_1^B \oplus \lang y\rang_1^B)=x \oplus y$

$AND:$$\lang z\rang^B = \lang x\rang^B \wedge \lang y\rang^B$ï¼šä½¿ç”¨é¢„å…ˆè®¡ç®—å¥½çš„å¸ƒå°”ä¹˜æ³•ä¸‰å…ƒç»„(Boolean multiplication triple),$(a,b,a\wedge b)$

$\lang c\rang^B=\lang a\rang^B \wedge \lang b\rang^B=(\lang a\rang_0^B \oplus \lang a\rang_1^B)\wedge(\lang b\rang_0^B \oplus \lang b\rang_1^B)=(\lang a\rang_0^B \wedge \lang b\rang_0^B)\oplus(\lang a\rang_0^B \wedge \lang b\rang_1^B)\oplus(\lang a\rang_1^B \wedge \lang b\rang_0^B)\oplus(\lang a\rang_1^B \wedge \lang b\rang_1^B)$

è¿™é‡Œä¸€æ ·å¯ä»¥ä½¿ç”¨ä¸ç»æ„ä¼ è¾“ï¼Œå››é€‰ä¸€ã€äºŒé€‰ä¸€,Aå…ˆé¢„å¤„ç†ç»“æœï¼Œæ ¹æ®Bçš„ç§˜å¯†æ¥é€‰æ‹©ç»“æœã€‚

- $P_i$è®¡ç®—$\lang e\rang_i^B=\lang x\rang_i^B \oplus \lang a\rang_i^B$å’Œ$\lang f\rang_i^B=\lang y\rang_i^B \oplus \lang b\rang_i^B$
- åŒæ–¹è®¡ç®—$e=Rec^B(e)=x\oplus a$å’Œ$f=Rec^B(f)=y\oplus b$
- $P_iè®¡ç®—\lang z\rang_i^B=ief \oplus f\lang a\rang_i^B \oplus e\lang b\rang_i^B \oplus \lang c\rang_i^B$

- é‡æ„$z=\lang z\rang_0^B \oplus \lang z\rang_1^B$

$$
\begin{aligned}
z &= \lang z\rang_0^B \oplus \lang z\rang_1^B\\
&=f \cdot \lang a\rang_0^B \oplus e\cdot\lang b\rang_0^B \oplus\lang c\rang_0^B \oplus (e \cdot f \oplus f\cdot\lang a\rang_1^B \oplus\ e\cdot\lang b\rang_1^B\oplus \lang c\rang_1^B)\\
&=e\cdot f \oplus f\cdot(\lang a\rang_0^B \oplus \lang a\rang_1^B)\oplus e\cdot(\lang b\rang_0^B \oplus \lang b\rang_1^B)\oplus(\lang c\rang_0^B \oplus\lang c\rang_1^B)\\
&=(x \oplus a) \wedge (y \oplus b) \oplus((y \oplus b) \wedge a)\oplus((x\oplus a)\wedge b)\oplus(a \wedge b)\\
&=x \wedge y \oplus x \wedge b \oplus a \wedge y \oplus a \wedge b \oplus y \wedge a \oplus b \wedge a \oplus x\wedge b \oplus a \wedge b \oplus a \wedge b \\
&=x \wedge y
\end{aligned}
$$

- ROTç”Ÿæˆå¸ƒå°”ä¹˜æ³•ä¸‰å…ƒç»„ï¼ˆMore Efficient Oblivious Transfer and
  Extensions for Faster Secure Computation*ï¼‰

ä¹˜æ³•ä¸‰å…ƒç»„$c_0 \oplus c_1=(a_0 \oplus a_1)\wedge (b_0 \oplus b_1)=(a_0 \wedge b_0)\oplus(a_0 \wedge b_1)\oplus(a_1 \wedge b_0)\oplus(a_1 \wedge b_1)$

![image-20230726154546190](assets\ABYè®ºæ–‡\image-20230726154546190.png)

![image-20230726155053943](assets\ABYè®ºæ–‡\image-20230726155053943.png)

ç®—æ³•ä¸­ï¼Œaæ˜¯éšæœºç”Ÿæˆçš„ï¼Œä½œä¸ºROTçš„è¾“å…¥ï¼ŒRæ²¡æœ‰è·å¾—å…³äº$b=x_0 \oplus x_1$çš„ä¿¡æ¯,å› ä¸º$x_0å’Œx_1$æ˜¯æœ‰ROTéšæœºç”Ÿæˆçš„ï¼Œè¿‡ç¨‹ä¸­Så’ŒRéƒ½ä¸çŸ¥é“åŒæ–¹çš„ä¿¡æ¯ï¼Œä½†æŒæœ‰äº†$aå’Œb$çš„ç§˜å¯†(è¿˜æœ‰ç”Ÿæˆçš„$uå’Œv$çš„ç§˜å¯†)ã€‚

ç®—æ³•ä¸­$ab=a(x_0 \oplus x_1)=(a(x_0 \oplus x_1)\oplus x_0)\oplus x_0=x_a \oplus x_0 = u \oplus v$

å¼•å…¥ä¸€ä¸ª$f^{ab}åŠŸèƒ½$ï¼Œå³ç®—æ³•1ä¸­çš„ROTå®ç°ï¼ŒåŒæ–¹ä¸æŒæœ‰è¾“å…¥æ¥æ”¶éšå³æ¯”ç‰¹$(a,u),(b,v)$ï¼Œçº¦æŸ$ab=u\oplus v$ã€‚è®©ä¸¤æ–¹å……å½“Rå’ŒSï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨ä¸­ï¼Œ$P_0$å½“ä½œRæ¥æ”¶$(a_0,u_0)$ï¼Œ$P_1$ä½œä¸ºSå¾—åˆ°$(b_1,v_1)$ï¼Œæœ‰$(a_0b_1)=u_0\oplus v_1$ã€‚æœ€å$p_1(a_0,u_0,b_0,v_0,c_0), p_2(a_1,u_1,b_1,v_1,c_1)$,å…¶ä¸­$c_i=a_ib_i \oplus u_i \oplus v_i$ã€‚

ä»ä¸Šæˆ‘ä»¬å¾—å‡º$\lang c\rang_0^B=\lang a \rang_0^B\lang b\rang_0^B \oplus\lang u\rang_0^B \oplus\lang v\rang_0^B$å’Œ$\lang c\rang_1^B=\lang a \rang_1^B\lang b\rang_1^B \oplus\lang u\rang_1^B \oplus\lang v\rang_1^B$

ä»è€Œ$c=a\wedge b=\lang a\rang_0^B\lang b\rang_0^B \oplus(\lang u\rang_0^B\oplus \lang v\rang_1^B)\oplus(\lang u_1^B\oplus \lang v\rang_0^B)\oplus\lang a\rang_1^B\lang b\rang_1^B$

$=\lang a\rang_0^B\lang b\rang_0^B \oplus \lang a\rang_0^B\lang b\rang_1^B \oplus \lang a\rang_1^B\lang b\rang_0^B \oplus \lang a\rang_1^B\lang b\rang_1^B$



$MUX:$é€‰æ‹©é—¨$MUX(x,y,b):$å¦‚æœæ¯”ç‰¹b=0ï¼Œåˆ™è¿”å›xï¼Œå¦åˆ™è¿”å›yï¼Œå¯ä»¥ä½¿ç”¨R-OTå®ç°





#### Yao Sharing

$P_0ä½œä¸ºgarbler(åŠ ç å™¨),P_1ä½œä¸ºevaluator(è¯„ä¼°æ–¹),P_0åˆ©ç”¨free-XORå’Œpoint-permuteæŠ€æœ¯éšæœºé€‰æ‹©ä¸€ä¸ªå…¨å±€çš„k-bitçš„å­—ç¬¦ä¸²Rï¼Œå…¶ä¸­R[0]=1$

å¯¹äºæ¯ä¸€æ¡çº¿è·¯$w$,å¯¹åº”çš„$key$æ˜¯$k_0^w\in _R \{0,1\}^k, k_1^w=k_0^w \oplus R,$æœ€ä½æœ‰æ•ˆä½ä¹Ÿç§°ä½œç½®æ¢ä¸ºä½œä¸ºæ ‡ç­¾(permutation bit)ã€‚$k_1^w[0]=1-k_0^w[0]$

![image-20230723000616027](assets\ABYè®ºæ–‡\image-20230723000616027.png)

$P_0$æŒæœ‰æ¯ä¸€æ¡çº¿è·¯$w$çš„ä¸¤ä¸ªå¯†é’¥$k_0^w,k_1^w$ï¼Œ$P_1$æŒæœ‰å…¶ä¸­çš„ä¸€ä¸ªä½†ä¸çŸ¥é“å®ƒå¯¹åº”çš„æ˜æ–‡å€¼(0,1)ï¼Œå¯¹äºl-bitçš„å€¼ï¼Œå¹¶è¡Œæ‰§è¡Œ$l$æ¬¡ã€‚

$Share \, Value:$ $\lang x\rang^Y$å¯¹$x$è¿›è¡Œåˆ†äº«ï¼Œ$\lang x\rang_0^Y=k_0, \lang x\rang_1^Y=k_x=k_0 \oplus xR$

$Sharing:$ $Shr_0^Y(x):P_0ä»¤\lang x\rang_0^Y=k_0,ç„¶åå°†k_x = k_0\oplus xRå‘é€ç»™P_1$

$Shr_1^Y(x):$åŒæ–¹æ‰§è¡Œ$C-OT_k^l$ï¼Œå…¶ä¸­$P_0$ä½œä¸ºsenderï¼Œè¾“å…¥ç›¸å…³å‡½æ•°$f_R(x)=(x \oplus R)$,å¾—åˆ°$(k_0,k_1=k_0 \oplus R)$ï¼Œ$P_1$ä½œä¸ºReceiverï¼Œå°†$x$ä½œä¸ºé€‰æ‹©æ¯”ç‰¹ï¼Œå¾—åˆ°$\lang x\rang_1^Y=k_x$,å¯ä»¥å‘ç°å½“$x=0æ—¶ï¼Œk_0\oplus xR=k_0;x=1æ—¶,ä¸ºk_0 \oplus R=k_1$ã€‚$(k_0 \oplus R)x=k_0 \oplus xR$ã€‚

$Reconstruction:$$Rec_i^Y(x):$$P_1$å°†$\pi=\lang x\rang_1^Y[0]$å‘é€ç»™$P_0$ï¼Œ$P_0$è®¡ç®—$x=\lang x\rang_0^Y[0]\oplus\lang x\rang_1^Y[0]$

$XOR:$ $\lang z\rang^Y=\lang x\rang^Y \oplus \lang y\rang^Y$, $P_i$æœ¬åœ°è®¡ç®—$\lang z\rang_i^Y=\lang x\rang_i^Y \oplus \lang y\rang_i^Y$ï¼Œ$\lang z\rang^Y=\lang z\rang^Y_0 \oplus\lang z\rang_1^Y$

$AND:$$\lang z\rang^Y=\lang x\rang^Y \wedge\lang y\rang^Y$

- $P_0$ç”Ÿæˆgarbled table $Gb_{\lang z\rang_0^Y}(\lang x\rang_0^Y,\lang y\rang_0^Y)$ï¼Œ$P_0$å°†tableå‘é€ç»™$P_1$ï¼Œ
- $P_1$ä½¿ç”¨å¯†é’¥$\lang x\rang_1^Y,\lang y\rang^Y_1$è§£å¯†



### Sharing Conversions

#### Y2B

Yaoé‡æ„ç§˜å¯†æ—¶åªéœ€è¦ç”¨åˆ°permutation bitä¸¤ä¸ªä½çš„å¼‚æˆ–ï¼Œå¤„ç†æ–¹å¼æ˜¯ç›´æ¥åˆ©ç”¨è¿™ä¸ªæœ€ä½æœ‰æ•ˆä½ã€‚

$\lang x\rang_i^B=Y2B(\lang x\rang_i^Y)=\lang x\rang_0^Y[0]$



#### B2Y

å’Œ$Shr_1^Y$ç›¸ä¼¼ï¼šå¯¹äºå•ä¸ªbitï¼Œä»¤$x_0=\lang x\rang_0^B,x_1=\lang x\rang_1^B$ï¼Œ$P_0$éšæœºé€‰æ‹©$\lang x\rang_0^Y=k_0 \in_R\{0,1\}^k$ï¼Œç„¶ååŒæ–¹æ‰§è¡ŒOTï¼Œ$P_0(sender)$å°†æ¶ˆæ¯å¯¹$k_0\oplus x_0 R),k_0 \oplus(1-x_0)R$ä½œä¸ºè¾“å…¥ï¼Œ$P_1(receiver)$å°†$x_1$ä½œä¸ºé€‰æ‹©æ¯”ç‰¹ï¼Œç„¶åå°±å¯ä»¥å¾—åˆ°$\lang x\rang_1^Y=k_0\oplus (x_0 \oplus x_1)R=k_x$ã€‚

å½“$x_1=0$æ—¶ï¼Œ$(k_0\oplus x_0R)x_1=k_0 \oplus(x_0 \oplus x_1)R$;

å½“$x_1=1$æ—¶ï¼Œ$(k_0\oplus (1-x_0)R)x_1=k_0 \oplus(x_0\oplus x_1)R$



#### A2Y

ä»¤$x_0=\lang x\rang_0^A,x_1=\lang x\rang_1^A$ï¼Œç„¶åå¾—åˆ°$\lang x\rang_0^Y=Shr_0^Y(x_0),\lang x\rang_1^Y=Shr_1^Y(x_1)$,å¾—åˆ°$\lang x\rang^Y=\lang x\rang_0^Y +\lang x\rang_1^Y$

è®ºæ–‡ä¸­çš„"for l-bit values each operation is performed l times in paraller", æˆ‘çš„ç†è§£æ˜¯Yao GCæ˜¯é’ˆå¯¹å•bitç”Ÿæˆç”µè·¯çš„ï¼Œå¦‚æœæ˜¯l-bitå°±å¹¶è¡Œå¤„ç†$l$æ¬¡ã€‚æ‰€ä»¥ï¼Œè¿™é‡Œçš„$Shr_0^Y(x_0)ä»£è¡¨æ˜¯å¯¹x_0=\lang x\rang_0^A\in Z_{2^l}$çš„$l$æ¬¡å¤„ç†ã€‚



#### B2A

ä½¿ç”¨ç±»ä¼¼ç®—æœ¯ä¹˜æ³•ä¸‰å…ƒç»„çš„æ–¹æ³•ï¼Œå¯¹**æ¯ä¸ªä½**è¿›è¡Œä¸ç»æ„ä¼ è¾“ï¼Œç„¶åreceiverå°†è·å¾—çš„å€¼ç›¸åŠ è·å¾—ç®—æœ¯å€¼

$P_0$ä½œä¸ºsender,$P_1$ä½œä¸ºreceiveä¸€èµ·æ‰§è¡ŒOTï¼Œåœ¨ç¬¬$i$è½®OTä¸­ï¼Œ$P_0$éšæœºé€‰æ‹©$r_i \in_R\{0,1\}^l$å¹¶å¾—åˆ°æ¶ˆæ¯å¯¹$(s_{i0},s_{i1})$,å…¶ä¸­

$s_{i0}=(1-\lang x\rang_0^B \cdot 2^i -r_i)$

$s_{i1}=\lang x\rang_0^B[i]-r_i$

$P_1$ç”¨$\lang x\rang_1^B[i]$ä½œä¸ºé€‰æ‹©æ¯”ç‰¹,å¹¶å¾—åˆ°$s_{\lang x\rang_1^B[i]}=(\lang x\rang_0^B[i] \oplus\lang x\rang_1^B[i])\cdot 2^i-r_i$,

å¯ä»¥çœ‹å‡ºä¸Šé¢çš„$s_{i0},s_{i1}$å°±å¯¹åº”$\lang x\rang_1^B[i]$åˆ†åˆ«å–0å’Œ1çš„æƒ…å†µï¼Œç„¶åè®©$P_1$è¿›è¡ŒOTä¼ è¾“é€‰æ‹©ã€‚

æœ€å$P_0$è®¡ç®—$\lang x\rang_0^A=\sum_{i=1}^lr_i$,

$P_1$è®¡ç®—
$$
\begin{aligned}
\lang x\rang_1^A&=\sum_{i=1}^ls_{\lang x\rang_1^B[i]}\\
&=\sum_{i=1}^l(\lang x\rang_0^B[i] \oplus\lang x\rang_1^B[i]\cdot 2^i-\sum_{i=1}^lr_i)\\
&=\sum_{i=1}^lx[i]\cdot2^i-\sum_{i=1}^lr_i\\
&=x-\lang x\rang_0^A
\end{aligned}
$$


#### Y2A

$\lang x\rang^A=Y2A(\lang x\rang^Y)=B2A(Y2B(\lang x\rang^Y))$





### Design and Implementation

æˆ‘ä»¬çš„ABYæ¡†æ¶çš„ä¸»è¦è®¾è®¡ç›®æ ‡æ˜¯<u>å®ç°é«˜æ•ˆçš„åœ¨çº¿é˜¶æ®µ</u>ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨è®¾ç½®é˜¶æ®µå¹¶è¡Œæ‰¹é‡é¢„è®¡ç®—æ‰€æœ‰åŠ å¯†æ“ä½œçš„åŸå› (<u>åœ¨çº¿é˜¶æ®µä¸­å”¯ä¸€å‰©ä½™çš„åŠ å¯†æ“ä½œæ˜¯ç”¨äºè¯„ä¼°ä¹±ç ç”µè·¯çš„å¯¹ç§°åŠ å¯†)</u>ã€‚å¦‚æœæ— æ³•è¿›è¡Œé¢„è®¡ç®—ï¼Œåˆ™å¯ä»¥å°†è®¾ç½®é˜¶æ®µå’Œè”æœºé˜¶æ®µäº¤å‰è¿›è¡Œï¼Œä»¥å‡å°‘æ€»è®¡ç®—æ—¶é—´ã€‚

æˆ‘ä»¬çš„æ¡†æ¶é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°æ‰©å±•åˆ°é¢å¤–çš„å®‰å…¨è®¡ç®—æ–¹æ¡ˆã€è®¡ç®—ä½“ç³»ç»“æ„å’Œæ–°çš„æ“ä½œï¼ŒåŒæ—¶è¿˜å…è®¸åœ¨å®ç°çš„æ‰€æœ‰çº§åˆ«ä¸Šè¿›è¡Œç‰¹æ®Šç›®çš„çš„ä¼˜åŒ–ã€‚æˆ‘ä»¬çš„æ¡†æ¶é€šè¿‡å¯¹å…±äº«å’Œåè®®ç»†èŠ‚çš„å†…éƒ¨è¡¨ç¤ºè¿›è¡ŒæŠ½è±¡æ¥å…³æ³¨åº”ç”¨ç¨‹åºã€‚

æˆ‘ä»¬åœ¨c++ GMWå’ŒYaoçš„ä¹±ç ç”µè·¯å®ç°[19]çš„åŸºç¡€ä¸Šï¼Œé‡‡ç”¨ä¼˜åŒ–çš„ä¸¤æ–¹GMWä¾‹ç¨‹[69]ã€å›ºå®šå¯†é’¥AESä¹±ç ä¾‹ç¨‹[7]å’ŒOTæ‰©å±•å®ç°[1]ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬<u>æ²¡æœ‰ä½¿ç”¨æ•£åˆ—å‡½æ•°å®ä¾‹åŒ–ç›¸å…³é²æ£’å•å‘å‡½æ•°H</u> (cf. xII-D)ï¼Œè€Œæ˜¯ä½¿ç”¨å›ºå®šå¯†é’¥AESã€‚ç‰¹åˆ«åœ°ï¼Œæˆ‘ä»¬è®¡ç®—:H(x;t) = AESK(xâŠ•t)âŠ•xâŠ•tï¼Œå…¶ä¸­Kæ˜¯ä¸€ä¸ªå›ºå®šçš„AESå¯†é’¥ï¼Œtæ˜¯ä¸€ä¸ª(å”¯ä¸€çš„)å•è°ƒé€’å¢è®¡æ•°å™¨(ç±»ä¼¼äº[7])ã€‚ä½¿ç”¨Paillierå’ŒDGKç”Ÿæˆç®—æœ¯ä¹˜æ³•ä¸‰å…ƒç»„æ˜¯ä½¿ç”¨GNUå¤šç²¾åº¦ç®—æœ¯åº“(GMP)ç”¨Cç¼–å†™çš„ï¼Œå¹¶å—åˆ°libpaillierçš„å¯å‘ã€‚

#### Efficient Multiplication Triple Generation

1ã€æˆ‘ä»¬åŒ…å«äº†[26]ä¸­æå‡ºçš„å¯¹Paillierå¯†ç ç³»ç»Ÿçš„å‡ ç§ç®—æ³•ä¼˜åŒ–ï¼Œå¹¶ä½¿ç”¨æ‰“åŒ…[62]ï¼Œ<u>[66]å°†å¤šä¸ªä¹˜æ³•ä¸‰å…ƒç»„ç»„åˆæˆä¸€ä¸ªPaillierå¯†æ–‡</u>ã€‚æˆ‘ä»¬å¯¹Paillierå’ŒDGKçš„å®ç°ä¼˜åŒ–åŒ…æ‹¬ä½¿ç”¨å›ºå®šåŸºæ•°å¹‚å’Œä¸­å›½å‰©ä½™å®šç†(CRT)è¿›è¡ŒåŠ å¯†ï¼Œä»¥åŠä½¿ç”¨CRTè¿›è¡Œè§£å¯†ã€‚åœ¨ä¹˜æ³•ä¸‰é‡åè®®ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨åŒåŸºå¹‚ã€‚

æˆ‘ä»¬ä½¿ç”¨äº†ä¸¤ç§éƒ¨ç½²åœºæ™¯:æœ¬åœ°è®¾ç½®(å…·æœ‰ä½å»¶è¿Ÿã€é«˜å¸¦å®½çš„ç½‘ç»œ)å’Œæ´²é™…äº‘è®¾ç½®(å…·æœ‰é«˜å»¶è¿Ÿçš„ç½‘ç»œ)ã€‚è¿™ä¸¤ç§åœºæ™¯æ¶µç›–äº†è®¾è®¡ç©ºé—´ä¸­çš„ä¸¤ç§æç«¯æƒ…å†µ:å½±å“å¸ƒå°”å’Œç®—æœ¯å…±äº«æ€§èƒ½çš„å»¶è¿Ÿ

---

æœ¬åœ°è®¾ç½®ã€‚åœ¨æœ¬åœ°è®¾ç½®ä¸­ï¼Œæˆ‘ä»¬åœ¨ä¸¤å°å°å¼æœºä¸Šè¿è¡ŒåŸºå‡†æµ‹è¯•ï¼Œæ¯å°å°å¼æœºéƒ½é…å¤‡äº†è‹±ç‰¹å°”Haswell i7-4770K CPU, 3.5 GHzå’Œ16gb RAMï¼Œé€šè¿‡åƒå…†å±€åŸŸç½‘è¿æ¥ã€‚æœ¬åœ°è®¾ç½®ä¸­çš„å¹³å‡è¿è¡Œæ—¶æ–¹å·®ä¸º15%ã€‚å¯¹äºä½¿ç”¨æµæ°´çº¿è®¡ç®—è¿‡ç¨‹çš„ç®—æ³•(ä¾‹å¦‚ï¼Œä¹˜æ³•ä¸‰ä»£ç®—æ³•)ï¼Œæˆ‘ä»¬å‘é€å¤§å°ä¸º50kbçš„æ•°æ®åŒ…ã€‚

äº‘è®¾ç½®ã€‚åœ¨äº‘ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬åœ¨ä¸¤å°Amazon EC2 c3ä¸Šè¿è¡ŒåŸºå‡†æµ‹è¯•ã€‚å¤§å‹å®ä¾‹å…·æœ‰64ä½Intel XeonåŒæ ¸CPU, 2.8 GHzå’Œ3.75 GB RAMã€‚ä¸€ä¸ªè™šæ‹Ÿæœºä½äºç¾å›½ä¸œæµ·å²¸ï¼Œå¦ä¸€ä¸ªä½äºæ—¥æœ¬ã€‚è¯¥åœºæ™¯çš„å¹³å‡å¸¦å®½ä¸º70mbit /sï¼Œå»¶è¿Ÿä¸º170msã€‚åœ¨æˆ‘ä»¬çš„æµ‹é‡ä¸­ï¼Œæˆ‘ä»¬å¾ˆå°‘é‡åˆ°è¶…è¿‡å¹³å‡è¿è¡Œæ—¶é—´ä¸¤å€çš„å¼‚å¸¸å€¼ï¼Œè¿™å¯èƒ½æ˜¯ç”±ç½‘ç»œå¼•èµ·çš„ï¼Œæˆ‘ä»¬ä»ç»“æœä¸­çœç•¥äº†è¿™ä¸€ç‚¹ã€‚åœ¨äº‘è®¾ç½®ä¸­å¾—åˆ°çš„å¹³å‡è¿è¡Œæ—¶æ–¹å·®ä¸º25%ã€‚å¯¹äºä½¿ç”¨æµæ°´çº¿è®¡ç®—è¿‡ç¨‹çš„ç®—æ³•ï¼Œæˆ‘ä»¬åœ¨æ¯”æœ¬åœ°è®¾ç½®æ›´å¤§çš„å—ä¸Šæ“ä½œï¼Œå¹¶å‘é€å¤§å°ä¸º32 MBçš„æ•°æ®åŒ…ï¼Œä»¥å®ç°æ›´å°‘çš„é€šä¿¡è½®æ•°ã€‚

---

æ‰€æœ‰æœºå™¨éƒ½**ä½¿ç”¨AESæ–°æŒ‡ä»¤é›†(AES- ni)æ¥å®ç°å¯¹ç§°åŠ å¯†æ“ä½œçš„æœ€å¤§æ•ˆç‡**ã€‚é™¤éå¦æœ‰è¯´æ˜ï¼Œæ‰€æœ‰å®éªŒå‡ä¸ºå¹³å‡æ‰§è¡Œ10æ¬¡ã€‚

æˆ‘ä»¬é’ˆå¯¹é—ç•™ã€ä¸­æœŸå’Œé•¿æœŸå®‰å…¨å‚æ•°(å‚è§xIII-Aï¼Œæ–‡ä¸­æŒ‡çš„æ˜¯å…¬é’¥å®‰å…¨å‚æ•°)å¯¹ç®—æœ¯ä¹˜æ³•ä¸‰å…ƒç»„(ç”¨äºç®—æœ¯å…±äº«ä¸­çš„ä¹˜æ³•)çš„ç”Ÿæˆè¿›è¡ŒåŸºå‡†æµ‹è¯•ã€‚

xII-C)å’Œç¼–ç¨‹è¯­è¨€ä¸­ä½¿ç”¨çš„å…¸å‹æ•°æ®ç±»å‹å¤§å°($l\in {8;16;32;64}$)ï¼Œä½¿ç”¨ä¸¤ä¸ªçº¿ç¨‹ã€‚æˆ‘ä»¬æµ‹é‡äº†100,000ä¸ªä¹˜æ³•ä¸‰å…ƒç»„çš„ç”Ÿæˆï¼Œ<u>ä¸åŒ…æ‹¬base- otå’Œå…¬é’¥å’Œç§é’¥çš„ç”Ÿæˆæ—¶é—´</u>ï¼Œæˆ‘ä»¬åœ¨é™„å½•xAä¸­åˆ†åˆ«æè¿°äº†å®ƒä»¬

è¡¨ä¸­æè¿°äº†ç”Ÿæˆä¸€ä¸ªä¹˜æ³•ä¸‰å…ƒç»„çš„é€šä¿¡æˆæœ¬å’Œå¹³å‡è¿è¡Œæ—¶é—´

![image-20230726181052168](assets\ABYè®ºæ–‡\image-20230726181052168.png)

åŸºäºOTçš„åè®®æ€»æ˜¯æ¯”åŸºäºPaillierå’ŒåŸºäºDGKçš„åè®®æ›´å¿«ã€‚åœ¨ä¹˜æ³•ä¸‰å…ƒç»„çš„æ„é€ ä¸­ï¼ŒåŸºäºOTçš„æ„é€ åè®®æ¯”åŸºäºåŒæ€çš„æ„é€ åè®®ï¼Œç”±äºåŠ å¯†æŒ‡æ•°æ›´çŸ­ï¼Œå¯†æ–‡å¤§å°æ›´å°ï¼ŒDGKåœ¨æ‰€æœ‰å‚æ•°ä¸Šéƒ½æ¯”Paillieræ›´æœ‰æ•ˆï¼Œä½†æ˜¯DGKçš„è¿è¡Œæ—¶é—´å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºä¹˜æ³•ä¸‰å…ƒç»„çš„ä½é•¿ï¼Œæ‰€ä»¥å¯¹äºéå¸¸å¤§çš„ä¹‹Paillieræ›´å¯å–

åœ¨é€šä¿¡æ–¹é¢ï¼ŒåŸºäºDGKçš„åè®®æ¯”åŸºäºOTçš„åè®®åœ¨æ›´é•¿çš„æ¯”ç‰¹é•¿åº¦ï¼ˆl=32,64ï¼‰ä¸Šæ›´å¥½ï¼Œ<u>è€Œå¯¹äºçŸ­çš„æ¯”ç‰¹é•¿åº¦ï¼ŒOTè¡¨ç°æ›´å¥½</u>

----

è®ºæ–‡é€šè¿‡ä¸‰ä¸ªç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œæ¼”ç¤ºäº†ABYæ¡†æ¶å¯ä»¥ç”¨äºå¤šä¸ªéšç§ä¿æŠ¤åº”ç”¨ç¨‹åº

#### Modular Exponentiation

æˆ‘ä»¬é€šè¿‡ä½¿ç”¨å¹³æ–¹ä¹˜ç®—æ³•å®ç°æ¨¡å¹‚ï¼Œç»™å‡ºABYæ¡†æ¶ä¸­åŠŸèƒ½æè¿°çš„ç¤ºä¾‹ã€‚æˆ‘ä»¬å°†åŠŸèƒ½å®ä¾‹åŒ–ä¸ºæ··åˆ(a +B+Y)å’Œçº¯Yao(ä»…Y)åè®®ï¼Œå¹¶å¯¹ä¸¤è€…è¿›è¡ŒåŸºå‡†æµ‹è¯•ã€‚

åœ¨æˆ‘ä»¬çš„åè®®æè¿°ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæ‰€ä½¿ç”¨çš„æ¯ä¸ªå…±äº«æ˜¾å¼å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡:ç®—æœ¯å…±äº«asã€å¸ƒå°”å…±äº«bå’ŒYaoå…±äº«ysã€‚è¿™äº›å¯¹è±¡ä¸ºæ¯ä¸ªå…±äº«ä¸­çš„åŸå­æ“ä½œæä¾›æ¥å£ï¼Œå¹¶ä»åº•å±‚è¡¨ç¤ºä¸­æŠ½è±¡å‡ºæ¥ã€‚å¯¹åº”çš„å…±äº«ç±»å‹åˆ†åˆ«ä¸ºashrã€bshrå’Œyshrã€‚æ¨¡å¹‚å‡½æ•°çš„è¾“å…¥æ˜¯ä¸€ä¸ªåº•æ•°$base$ï¼Œä¸€ä¸ªæŒ‡æ•°$exp$ï¼Œæ¨¡æ•°$mod$å’Œè¾“å…¥$len$çš„é•¿åº¦ã€‚åœ¨Arithmeticç®—æ•°å…±äº«ä¸­æ‰§è¡Œä¹˜æ³•(MUL)ï¼Œåœ¨Yaoå…±äº«ä¸­æ‰§è¡ŒåŒ–ç®€(rem)ï¼Œåœ¨Booleanä¸­æ‰§è¡Œæ¡ä»¶ä¹˜æ³•(æ ¹æ®å…±äº«çš„æŒ‡æ•°ä½0å’Œ1è¿›è¡Œé€‰æ‹©ç›¸ä¹˜)ã€‚ä¹Ÿå°±æ˜¯è¯´ç®—æœ¯å…±äº«ä¸­å…±äº«åŸºæ•°ã€å¸ƒå°”å…±äº«ä¸­å…±äº«æŒ‡æ•°ã€åœ¨å§šå…±äº«ä¸­å…±äº«æ¨¡æ•°ã€‚

- åœ¨æœ¬åœ°å’Œäº‘åœºæ™¯ä¸­ï¼Œå¯¹' l-bit= 32ä½å€¼è¿›è¡Œå•ä¸ªåŸå­æ“ä½œçš„è®¾ç½®æ—¶é—´(ä»¥Âµsä¸ºå•ä½)å’Œé€šä¿¡(ä»¥å­—èŠ‚ä¸ºå•ä½)ï¼Œä½¿ç”¨é•¿æœŸå®‰å…¨å‚æ•°å¹³å‡è¶…è¿‡1000æ¬¡æ“ä½œã€‚

![image-20230727144638122](assets\ABYè®ºæ–‡\image-20230727144638122.png)

![image-20230727145843354](assets\ABYè®ºæ–‡\image-20230727145843354.png)

æ¨¡å—åŒ–æ±‚å¹‚:æ¸…å•1ä¸­å…³äºlen= 32ä½è¾“å…¥å’Œé•¿æœŸå®‰å…¨æ€§çš„æ¨¡å—åŒ–æ±‚å¹‚çš„è®¾ç½®ã€åœ¨çº¿å’Œæ€»è¿è¡Œæ—¶é—´(å•ä½)ã€é€šä¿¡å’Œæ¶ˆæ¯æ•°ã€‚æœ€å°çš„æ¡ç›®ç”¨ç²—ä½“æ ‡å‡ºã€‚

æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°A+B+Yåè®®æœ‰å¤§é‡çš„é€šä¿¡è½®ï¼Œè¿™æ˜¯ç”±äºå¤§é‡çš„A2Yå’Œy2aè½¬æ¢ã€‚å› æ­¤ï¼Œå®ƒåœ¨æœ¬åœ°è®¾ç½®ä¸­æ¯”Y-onlyåè®®æ€§èƒ½æ›´å¥½ï¼Œä½†åœ¨å…·æœ‰æ›´é«˜ç½‘ç»œå»¶è¿Ÿçš„äº‘è®¾ç½®ä¸­æ€§èƒ½æ›´å·®ã€‚ä¸¤ç§åè®®çš„é€šä¿¡å¤æ‚åº¦ä¹Ÿç›¸ä¼¼ï¼Œè¿™æ˜¯ç”±äºåœ¨Yaoå…±äº«ä¸­è¯„ä¼°çš„remæ“ä½œé€ æˆçš„ï¼Œæ˜¯ä¸»è¦çš„é€šä¿¡ç“¶é¢ˆã€‚

#### Private Set Intersection

åœ¨ç§æœ‰é›†åˆäº¤é›†åº”ç”¨ç¨‹åºä¸­ï¼ŒåŒæ–¹<u>å¸Œæœ›ç¡®å®šå®ƒä»¬çš„nä¸ªå…ƒç´ é›†åˆçš„äº¤é›†</u>ï¼Œè€Œ<u>ä¸é€éœ²äº¤é›†ä¸­ä¸åŒ…å«çš„å…ƒç´ </u>ã€‚è®¡ç®—ç§æœ‰é›†äº¤é›†åŠŸèƒ½çš„å¸ƒå°”ç”µè·¯åœ¨[37]ä¸­æœ‰æè¿°ï¼Œå¹¶ä½¿ç”¨Yaoçš„ä¹±ç ç”µè·¯åè®®è¿›è¡Œè¯„ä¼°ã€‚å¯¹äºå…·æœ‰è¾ƒé•¿ä½é•¿åº¦å…ƒç´ çš„è¾ƒå¤§é›†ï¼Œ**æ’åº-æ¯”è¾ƒ-æ´—ç‰Œé›†äº¤å‰ç”µè·¯**æ˜¯æœ€æœ‰æ•ˆçš„;å¯¹äºnä½å…ƒç´ çš„é›†åˆï¼Œè¯¥ç”µè·¯æœ‰O(n log2 n)ä¸ªä¸é—¨ã€‚æ–‡çŒ®[64]å¯¹ç°æœ‰åŸºäºå„ç§æŠ€æœ¯çš„PSIåè®®è¿›è¡Œäº†æ¯”è¾ƒã€‚å…¶ä¸­ï¼Œä»–ä»¬ä½¿ç”¨çº¯Yaoçš„ä¹±ç ç”µè·¯å’Œçº¯GMWæ‰§è¡ŒPSIï¼Œå¹¶æ¯”è¾ƒå®ƒä»¬åœ¨ä¸åŒè®¾ç½®ä¸‹çš„æ€§èƒ½ã€‚

ABYæ¡†æ¶ä¸­å®ç°äº†[37]çš„æ’åº-æ¯”è¾ƒ-æ´—ç‰Œç”µè·¯ï¼Œå¹¶å°†å…¶<u>å®ä¾‹åŒ–ä¸ºä¸‰ä¸ªç‰ˆæœ¬</u>:<u>ä»…Yaoå®ä¾‹åŒ–</u><u>(Y-only)</u>ï¼Œ<u>ä»…å¸ƒå°”å®ä¾‹åŒ–(B-only)</u>å’Œ<u>æ··åˆå®ä¾‹åŒ–(B+Y)</u>ï¼Œè¯¥å®ä¾‹åŒ–ä½¿ç”¨Yaoå…±äº«è¯„ä¼°æ’åºå’Œæ¯”è¾ƒéƒ¨åˆ†ï¼Œä½¿ç”¨<u>å¸ƒå°”å…±äº«è¯„ä¼°æ´—ç‰Œéƒ¨åˆ†</u>å¸ƒå°”å…±äº«å¾—ç›Šäºå¯¹é¢‘ç¹å‡ºç°åœ¨ç”µè·¯shuffleéƒ¨åˆ†çš„MUXæ“ä½œçš„æ”¹è¿›è¯„ä¼°ã€‚

- åœ¨æœ¬åœ°å’Œäº‘åœºæ™¯ä¸­ï¼Œå¯¹' l-bit= 32ä½å€¼è¿›è¡Œä¸€æ¬¡åŸå­æ“ä½œçš„åœ¨çº¿æ—¶é—´(ä»¥Âµsä¸ºå•ä½)å’Œé€šä¿¡(ä»¥å­—èŠ‚ä¸ºå•ä½)ï¼Œä½¿ç”¨é•¿æœŸå®‰å…¨å‚æ•°å¹³å‡è¶…è¿‡1000æ¬¡é¡ºåº/å¹¶è¡Œæ“ä½œã€‚

![image-20230727150641343](assets\ABYè®ºæ–‡\image-20230727150641343.png)

![image-20230727150745725](assets\ABYè®ºæ–‡\image-20230727150745725.png)

Private Set Intersectionåº”ç”¨ç¨‹åºåœ¨**n = 4096ä¸ªé•¿åº¦ä¸º32ä½**å’Œé•¿æœŸå®‰å…¨æ€§çš„å…ƒç´ ä¸Šçš„è®¾ç½®ã€åœ¨çº¿å’Œæ€»è¿è¡Œæ—¶é—´(å•ä½ä¸ºç§’)ã€é€šä¿¡å’Œæ¶ˆæ¯æ•°é‡ã€‚æœ€å°çš„æ¡ç›®ç”¨ç²—ä½“æ ‡å‡ºã€‚

å»¶è¿Ÿ(Seq)ï¼šå»¶è¿Ÿå–å†³äºéƒ¨ç½²åœºæ™¯çš„å»¶è¿Ÿï¼Œè™½ç„¶åœ¨æœ¬åœ°ä¸­ä»Yåˆ°Aæ¯”å•çº¯åœ¨Yä¸­è¿è¡Œä¹˜æ³•æ›´æœ‰æ•ˆï¼Œä½†æ˜¯åœ¨äº‘ç«¯ä¸­ï¼Œç”¨Yæ‰§è¡Œä¹˜æ³•æ›´æœ‰æ•ˆï¼Œè¿™æ˜¯å› ä¸ºåœ¨Aå’ŒBä¸­æœ‰è¾ƒå¤šçš„é€šä¿¡è½®æ¬¡ï¼Œç›¸æ¯”ä¹‹ä¸‹ï¼ŒYå…·æœ‰æ’å®šæ•°é‡çš„äº¤äº’è½®æ¬¡ï¼Œå› æ­¤æ›´é€‚åˆé«˜å»¶è¿Ÿçš„ç½‘ç»œ

ååé‡(Par)ï¼šç”µè·¯ä¸­è¿ç®—çš„å¹¶è¡Œå®ä¾‹å¤§å¤§è·³äº†Aå’ŒBçš„åœ¨çº¿è¿è¡Œæ—¶é—´ï¼Œè™½ç„¶Yä¹Ÿå—ç›Šäºå¹¶è¡Œçš„ç”µè·¯å®ä¾‹åŒ–ï¼Œä½†æ˜¯Yåªéœ€è¦å¯¹ä¸€ä¸ªç”µè·¯è¿›è¡Œæ„å»ºå’Œå¤šæ¬¡å¹¶è¡Œçš„è¯„ä¼°ï¼Œæ‰€ä»¥Aå’ŒBæ¯”Yæ›´æœ‰åˆ©

ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œå…±äº«ä¹‹é—´çš„è½¬æ¢æˆæœ¬å¾ˆå°ï¼Œç”šè‡³å…è®¸å•ä¸ªæ“ä½œè¿›è¡Œä¸€è½®å®Œæ•´çš„è½¬æ¢ï¼Œä»¥ä¹˜æ³•ä¸ºä¾‹ï¼Œè¡¨ç°æœ€å¥½çš„æ˜¯Arithmetic Sharingï¼Œä»Yè½¬æ¢ä¸ºAå†è½¬æ¢å›æ¥æ¯”åœ¨Yä¸­æ‰§è¡Œä¹˜æ³•æ›´å¥½

#### **Biometric Matching**

ä¸€æ–¹æƒ³è¦ç¡®å®šå…¶ç”Ÿç‰©ç‰¹å¾æ ·æœ¬æ˜¯å¦ä¸å­˜å‚¨åœ¨å¦ä¸€æ–¹æŒæœ‰çš„æ•°æ®åº“ä¸­çš„å¤šä¸ªç”Ÿç‰©ç‰¹å¾æ ·æœ¬åŒ¹é…ï¼Œè®¡ç®—æŸ¥è¯¢ä¸æ•°æ®åº“ä¸­æ‰€æœ‰ç”Ÿç‰©ç‰¹å¾ä¹‹é—´çš„æ¬§æ°è·ç¦»çš„å¹³æ–¹ï¼Œç„¶åç¡®å®šè¿™äº›è·ç¦»ä¸­çš„æœ€å°å€¼ã€‚

æ¯ä¸ªç‰¹å¾æ ·æœ¬æœ‰4ä¸ªç»´åº¦ä¸”é•¿åº¦å‡ä¸º32bitï¼Œæ•°æ®åº“å¤§å°$n=512$ï¼Œå…¶ä¸­$P_0$è¾“å…¥æ•°æ®åº“$S_{i,j}$ï¼Œ$P_1$è¾“å…¥æ ·æœ¬$C_i$ï¼Œç„¶ååŒæ–¹å…±åŒè®¡ç®—$min(\sum_{i=1}^d(s_{i,1}-C_i)^2,....\sum_{i=1}^d(s_{i,n-C_i})^2)$

![image-20230727153455103](assets\ABYè®ºæ–‡\image-20230727153455103.png)

æ··åˆåè®®æ¯”å•ä¸ªåè®®è¡¨ç°è¦å¥½ã€‚é€šä¿¡é™ä½äº†è¿‘20å€ï¼ŒA+Yåœ¨åœ¨çº¿é˜¶æ®µå’Œæ€»è¿è¡Œæ—¶é—´é‡Œè¡¨ç°æœ€ä½³ï¼Œæ¯”å•çº¯çš„åè®®å¿«äº†è¿‘7å€ã€‚

ä½¿ç”¨æ··åˆåè®®è¦æ¯”å•ä¸ªåè®®æ›´å¥½ã€‚
